define(["require","exports","preact/jsx-runtime","preact/hooks","../../components/baseSectionContainer/BaseSectionContainer","../../hooks/useFetchSectionData","ojs/ojarraydataprovider","ojs/ojmutablearraydataprovider","../../components/tabBarTemplateRenderer/TabBarTemplate","../../router/SubRoute","./Patches","../../hooks/useDynamicFilters","./PatchComponents","../../components/sectionBottomContext/SectionBottomContext","ojs/ojselectsingle","ojs/ojlabel","ojs/ojnavigationlist","ojs/ojmessagebanner","oj-c/message-banner"],(function(require,e,o,t,l,n,s,a,i,d,c,u,r,h){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=()=>{var e,v,m;const{filters:p,dispatchFilters:j,onFilterChangeHandler:x}=(0,u.default)({}),b=(0,t.useCallback)((e=>{var o,t,l,n,s,a,i,d;j({type:u.FilterActions.SET_MULTIPLE_FILTER_FIELDS,payload:[{field:"home",value:(null===(l=null===(t=null===(o=null==e?void 0:e.context)||void 0===o?void 0:o.patchAnalysis)||void 0===t?void 0:t.homeDropdown)||void 0===l?void 0:l.length)>0?e.context.patchAnalysis.homeDropdown[0].value:null},{field:"host",value:(null===(a=null===(s=null===(n=null==e?void 0:e.context)||void 0===n?void 0:n.patchAnalysis)||void 0===s?void 0:s.hosts)||void 0===a?void 0:a.length)>0?null===(d=null===(i=null==e?void 0:e.context)||void 0===i?void 0:i.patchAnalysis)||void 0===d?void 0:d.hosts[0].value:null}]})}),[j]),{data:g,isLoading:y,error:f}=(0,n.default)("../js/jsons/insights/patchAnalysisJson.js",b),A=(0,t.useMemo)((()=>{var e,t;return g?[{id:"patches",name:"Patches",element:(0,o.jsx)(c.default,{data:g.context.patchAnalysis.patches,home:null!==(e=p.home)&&void 0!==e?e:null,host:null!==(t=p.host)&&void 0!==t?t:null})},{id:"components",name:"Components",element:(0,o.jsx)(r.default,{data:g.context.patchAnalysis.components,home:p.home,host:p.host})}]:[]}),[g,p.home,p.host]),[C,w]=(0,t.useState)("patches"),S=(0,t.useMemo)((()=>new s(A,{keyAttributes:"id"})),[A]),T=(0,t.useMemo)((()=>{var e,o;return g&&(null===(o=null===(e=null==g?void 0:g.context)||void 0===e?void 0:e.patchAnalysis)||void 0===o?void 0:o.homeDropdown)?new s(g.context.patchAnalysis.homeDropdown,{keyAttributes:"value"}):new s([])}),[g]),k=(0,t.useMemo)((()=>{var e,o;return g&&(null===(o=null===(e=null==g?void 0:g.context)||void 0===e?void 0:e.patchAnalysis)||void 0===o?void 0:o.hosts)?new s(g.context.patchAnalysis.hosts,{keyAttributes:"value"}):new s([])}),[g]),M=(0,t.useMemo)((()=>{var e,o,t,l,n,s;const i={};for(const d in null===(t=null===(o=null===(e=null==g?void 0:g.context)||void 0===e?void 0:e.patchAnalysis)||void 0===o?void 0:o.patches)||void 0===t?void 0:t.missingPatches)i[d]=new a(null===(s=null===(n=null===(l=null==g?void 0:g.context)||void 0===l?void 0:l.patchAnalysis)||void 0===n?void 0:n.patches)||void 0===s?void 0:s.missingPatches[d],{keyAttributes:"patchId"});return i}),[g]);return(0,o.jsx)(l.default,{data:g,isLoading:y,error:f,children:(0,o.jsxs)("section",{children:[(0,o.jsxs)("div",{class:"oj-flex oj-sm-margin-3x-bottom oj-sm-align-items-center flex-gap",children:[(0,o.jsx)("oj-label",{class:"patchAnalysis__filterLabel",children:"Home"}),(0,o.jsx)("oj-select-single",{labelHint:"Select Home",labelEdge:"inside",class:"oj-form-control-width-md",value:null==p?void 0:p.home,data:T,onvalueChanged:e=>x(e,"home")}),(0,o.jsx)("oj-label",{class:"patchAnalysis__filterLabel margin-left-auto",children:"Host"}),(0,o.jsx)("oj-select-single",{labelHint:"Select Host",labelEdge:"inside",class:"oj-form-control-width-md",value:null==p?void 0:p.host,data:k,onvalueChanged:e=>x(e,"host")})]}),(0,o.jsx)("oj-tab-bar",{edge:"top",data:S,selection:C,class:"oj-sm-margin-2x-bottom",onselectionChanged:e=>{w(e.detail.value)},children:(0,o.jsx)("template",{slot:"itemTemplate",render:i.default})}),M[p.home]&&(0,o.jsx)("oj-c-message-banner",{onojClose:e=>{const o=M[p.home];o&&(o.data=o.data.filter((o=>o.patchId!==e.detail.key)))},class:"oj-sm-margin-2x-bottom",data:null!==(e=M[p.home])&&void 0!==e?e:null}),(0,o.jsx)("div",{children:A.map((e=>(0,o.jsx)(d.default,{currentPath:C,path:e.id,element:e.element,unmountElement:e.shouldUnmount})))}),g&&g.sectionMessage&&g.sectionTimeContext&&(0,o.jsx)(h.default,{label:null!==(v=g.sectionMessage)&&void 0!==v?v:"",badgeText:null!==(m=g.sectionTimeContext)&&void 0!==m?m:""})]})})}}));